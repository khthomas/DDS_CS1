---
title: "MSDS6306 Case Study 1"
author: "Joe Schueder"
date: "October 6, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
Introduction to the project. The introduction should not reference a project, persay. No part of this should be informal. The introduction needs to be written as if you are presenting the work to someone who has given you the data to analyze and wants to understand the result. Pretend its a presentation for a client. This may take some imagination of whom your client might be. If it sounds like a student presentation, that is not acceptable.

c. Briefly explain the purpose of the code. The explanations should appear as a sentence ortwo before or after the code chunk. Even though you will not be hiding the code chunks (so that I can see the code), you need to pretend that the client cant see them. Use R to code answers concerning the seven questions below.
Give clear, explicit answers to the questions. Just the code to answer the questions is not enough, even if the code is correct and gives the correct answer. You must state the answer in a complete sentence outside the code chunk.

```{r data import, include=TRUE}
getwd()
setwd ("C:/Users/jjschued/MSDS6306CaseStudy1/Raw Import Data/")
beers <- read.csv(file = "Beers.csv", sep=",", header=TRUE)
breweries <- read.csv(file = "Breweries.csv", sep=",", header=TRUE)

head(beers)
head(breweries)
```

1. How many breweries are present in each state?

```{r summarize by state}
library(plyr)
Statesum <- count(breweries, 'State')
Statesum <- Statesum[order(-Statesum$freq),]
colnames(Statesum) <- c("State", "Number of Breweries")
Statesum
```

2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.

```{r mege}
colnames(breweries)[1] <- "Brewery_id"
beerandbrew <- merge(breweries, beers, by=c("Brewery_id"), all= FALSE)
colnames(beerandbrew)[2] <- "Brewery"
colnames(beerandbrew)[5] <- "Beer"

head(beerandbrew)
tail(beerandbrew)

```

3. Report the number of NA's in each column.
```{r NACheck}

colSums(is.na(beerandbrew))

```

4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

```{r abvandibu}
library("reshape2")
abvandibu <- aggregate(beerandbrew[, 7:8], list(beerandbrew$State), median, na.rm=TRUE)
abvandibu$ABV = abvandibu$ABV*100

abvandibumelt <- melt(abvandibu, id=c("Group.1"))
abvandibumelt <-abvandibumelt[order(-abvandibumelt$variable),]
library("ggplot2")
qplot(x=Group.1, data=abvandibumelt, geom ="bar", weight=value, fill = variable) +
coord_flip()

                      
```

5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

```{r getmax}
maxabv <- beerandbrew[which.max(beerandbrew$ABV),]
maxabv$State
maxibu <- beerandbrew[which.max(beerandbrew$IBU),]
maxibu$State
```

6. Summary statistics for the ABV variable.
```{R summarystatsabv}
summary(beerandbrew$ABV)
```

7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.
```{r scatter}
plot(x= beerandbrew$IBU, 
     y= beerandbrew$ABV,
     main = "IBU vs ABV",
     xlab = "IBU",
     ylab = "ABV")
  abline(line(beerandbrew$IBU,beerandbrew$ABV))
  abline(lsfit(beerandbrew$IBU,beerandbrew$ABV))
```


You are welcome to use the ggplot2 library for graphs. Please ignore missing values inyour analysis. Make your best judgment of a relationship and EXPLAIN your answer.



Conclusion to the project. Summarize your findings from this exercise. The file must bereadable in GitHub. In other words, dont forget to keep the md file!!





